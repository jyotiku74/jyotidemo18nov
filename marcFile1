this code is by marc
